(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/write/write"],{"0e2c":function(t,e,a){"use strict";a.r(e);var n=a("1756"),s=a("1c4a");for(var i in s)"default"!==i&&function(t){a.d(e,t,function(){return s[t]})}(i);a("616a");var o=a("2877"),c=Object(o["a"])(s["default"],n["a"],n["b"],!1,null,null,null);e["default"]=c.exports},"0fe3":function(t,e,a){},1756:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",{staticClass:"container"},[a("view",{staticClass:"topper"}),a("view",{staticClass:"topper-box"},[a("view",{staticClass:"topper-box-list"},[a("view",{staticClass:"writeContent-left"},[a("image",{staticClass:"topper-sc-image",attrs:{src:"../../static/back.png",eventid:"b8d79bba-0"},on:{tap:t.goBack}}),a("text",{staticClass:"yulan"},[t._v(t._s(t.content.length)+"字")])]),a("view",{staticClass:"writeContent-right"},[t.show?a("text",{staticClass:"yulan cha",attrs:{eventid:"b8d79bba-1"},on:{tap:t.changeYL}},[t._v("取消")]):t._e(),t.show?t._e():a("text",{staticClass:"yulan",attrs:{eventid:"b8d79bba-2"},on:{tap:t.changeYL}},[t._v("预览")]),a("text",{staticClass:"fabu",attrs:{eventid:"b8d79bba-3"},on:{tap:t.postArticle}},[t._v("发布")])])])]),a("view",{staticClass:"list-border-space"}),t.show?t._e():a("view",{staticClass:"inputContent"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],staticClass:"write-title",attrs:{type:"text",placeholder:"请输入标题",eventid:"b8d79bba-4"},domProps:{value:t.title},on:{input:function(e){e.target.composing||(t.title=e.target.value)}}}),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],staticClass:"write-content",attrs:{"auto-height":"true",maxlength:"3000",placeholder:"输入内容",eventid:"b8d79bba-5"},domProps:{value:t.content},on:{input:function(e){e.target.composing||(t.content=e.target.value)}}})]),t.show?a("view",{staticClass:"inputContent"},[a("view",{staticClass:"grace-text "},[a("rich-text",{attrs:{nodes:t.content,bindtap:"tap",mpcomid:"b8d79bba-0"}})],1)]):t._e(),a("view",{staticClass:"comment-bottom"},[a("view",{staticClass:"list-border-space"}),a("view",[a("image",{staticClass:"comment-bottom-avatar",attrs:{src:"../../static/tupian.png",eventid:"b8d79bba-6"},on:{tap:t.chooseImg}})])])])},s=[];a.d(e,"a",function(){return n}),a.d(e,"b",function(){return s})},"1c4a":function(t,e,a){"use strict";a.r(e);var n=a("7217"),s=a.n(n);for(var i in n)"default"!==i&&function(t){a.d(e,t,function(){return n[t]})}(i);e["default"]=s.a},"616a":function(t,e,a){"use strict";var n=a("0fe3"),s=a.n(n);s.a},7217:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a={data:function(){return{title:"",content:"",userId:t.getStorageSync("login_key").userId,imgs:[],show:!1}},onLoad:function(){},methods:{goBack:function(){t.navigateBack({})},changeYL:function(){this.show=!this.show},chooseImg:function(){var e=this;t.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album"],success:function(a){console.log(JSON.stringify(a.tempFilePaths)),t.uploadFile({url:e.apiServer+"/avatar/upload",filePath:a.tempFilePaths[0],name:"file",success:function(t){console.log(t.data),e.imgs.push(t.data),e.content+='<img src="'+t.data+'" width = "100%"/>'}})}})},postArticle:function(){var e=this;t.request({url:this.apiServer+"/article/add",method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:{uId:this.userId,title:this.title,content:"<div>"+this.content+"</div>"},success:function(a){if(0===a.data.code){var n=a.data.data;console.log(n),t.showToast({title:"简阅钻+10"}),t.request({url:"http://47.101.34.195:8080/api/img/add",method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:{aId:n,imgs:JSON.stringify(e.imgs)},success:function(t){0===t.data.code&&console.log("文章图片地址已写入数据库")}}),t.switchTab({url:"../index/index"})}},complete:function(){var a=this,n=t.getStorageSync("login_key").score+10;t.request({url:"http://47.101.34.195:8080/api/user/score",method:"post",header:{"content-type":"application/x-www-form-urlencoded"},data:{userId:e.userId,score:n},success:function(n){console.log(n.data),a.promptVisible=!1,t.request({url:"http://47.101.34.195:8080/api/user/"+t.getStorageSync("login_key").userId,method:"GET",data:{userId:e.userId},header:{"content-type":"application/json"},success:function(e){0==e.data.code&&t.setStorageSync("login_key",{userId:e.data.data.id,nickname:e.data.data.nickname,avatar:e.data.data.avatar,token:e.data.data.token,score:e.data.data.score,mobile:e.data.data.mobile,login:!0})}})}})}})}}};e.default=a}).call(this,a("6e42")["default"])},db67:function(t,e,a){"use strict";a("175f");var n=i(a("b0ce")),s=i(a("0e2c"));function i(t){return t&&t.__esModule?t:{default:t}}Page((0,n.default)(s.default))}},[["db67","common/runtime","common/vendor"]]]);